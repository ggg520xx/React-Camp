"use strict";(self.webpackChunkreactapp=self.webpackChunkreactapp||[]).push([[305],{5305:function(e,t,r){r.r(t),r.d(t,{default:function(){return m}});var n=r(1413),a=r(4165),c=r(5861),o=r(9439),s=r(2791),u=r(9414),l=r(9916),i=r(1243),f=r(1941),d=r(8527),p=r(4522);var h=r(184);var m=function(){var e=localStorage.getItem("id");console.log(e);var t=(0,s.useState)(!1),r=(0,o.Z)(t,2),m=r[0],g=r[1],v=(0,s.useState)(!1),x=(0,o.Z)(v,2),Z=x[0],y=x[1],S=(0,s.useState)([]),b=(0,o.Z)(S,2),k=b[0],w=b[1],j=(0,s.useState)(!1),I=(0,o.Z)(j,2),N=I[0],C=I[1];return(0,s.useEffect)((function(){i.Z.get("http://localhost:3000/orders?userId=".concat(e,"&orderExpired=false&orderCancel=false&_expand=camp&_expand=campinfo")).then((function(e){var t=e.data;console.log(t);var r=t.sort((function(e,t){return function(e,t){(0,p.Z)(2,arguments);var r=(0,d.Z)(e),n=(0,d.Z)(t),a=r.getTime()-n.getTime();return a<0?-1:a>0?1:a}((0,f.default)(e.roomStart,"yyyy\u5e74MM\u6708dd\u65e5",new Date),(0,f.default)(t.roomStart,"yyyy\u5e74MM\u6708dd\u65e5",new Date))}));w(r),C(!N)})).catch((function(e){console.log(e)}))}),[m]),(0,s.useEffect)((function(){var e=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.Z.get("http://localhost:3000/feedbacks?campId=".concat(t));case 3:return r=e.sent,e.abrupt("return",r.data);case 7:return e.prev=7,e.t0=e.catch(0),console.error("Error fetching feedback data for campId ".concat(t,":"),e.t0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),t=function(){var t=(0,c.Z)((0,a.Z)().mark((function t(){var r,c,o;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(k&&k.length>0)){t.next=8;break}return r=k.map((function(t){return e(t.campId)})),t.next=4,Promise.all(r);case 4:c=t.sent,o=k.map((function(e,t){var r=(c[t]||[]).map((function(e){return e.totalScore})),a=r.reduce((function(e,t){return e+t}),0),o=r.length>0?(a/(5*r.length)).toFixed(1):0,s=r.length;return(0,n.Z)((0,n.Z)({},e),{},{totalScore:a,totalAverageScore:o,scoreNum:s})})),console.log(o),w(o);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}),[Z,N]),(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)(u.iY,{className:"py-5",children:[(0,h.jsxs)("div",{className:"h-[100px]",children:[(0,h.jsxs)("h2",{className:"text-xl font-bold",children:["\u6b61\u8fce\uff0c\u60a8\u5c1a\u6709 ",(0,h.jsx)("span",{className:"text-blue-500",children:k&&k.length})," \u7b46 \u884c\u7a0b\u5f85\u9032\u884c\u6216\u9032\u884c\u4e2d"]}),(0,h.jsx)("strong",{children:"\u6e96\u5099\u597d\u958b\u59cb\u60a8\u7684\u884c\u7a0b\u4e86\u55ce"})]}),(0,h.jsx)(l.Z,{getdata:k,status:"ing",delayGetStar:Z,setDelayGetStar:y,cancelOrder:m,setCancelOrder:g})]})})}}}]);
//# sourceMappingURL=305.c2dd9570.chunk.js.map