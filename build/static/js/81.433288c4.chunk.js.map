{"version":3,"file":"static/js/81.433288c4.chunk.js","mappings":"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","sources":["components/member/MemberOrder.jsx"],"sourcesContent":["\n\n\nimport React, { useState, useEffect } from \"react\";\n\nimport { DivContentZone, DivCoverStyled } from '../memberBasic/MemberBasicStyle'\n\nimport MemberBasic from '../memberBasic/MemberBasic'\nimport axios from 'axios';\n\nimport { campOrder } from '../../images/member/MemberMange';\n\n\n\n\n\n\n\nfunction MemberOrder() {\n\n\n    // 過去和取消的選取\n    const [uiTurn, setUiTurn] = useState(null);\n    \n    \n    // 發送評價後的馬上刷新\n    const [finFeedback, setFinFeedback] = useState(false);\n\n\n\n    let userIdOrder = localStorage.getItem('id');\n    console.log(userIdOrder)\n\n\n    const [statusPast, setStatusPast] = useState(false);\n\n    \n\n\n\n\n\n\n\n    const [campDataResultPast, setCampDataResultPast] = useState([]);\n    \n    // 額外控制 當我完成評價後 也得馬上合併一次資料 否則會跳為抓不到資料\n    const [otherCon, setOtherCon] = useState(false);\n\n\n    function useDataPast() {\n        // const [Data, setData] = useState(null);\n        useEffect(() => {\n            axios.get(`http://localhost:3000/orders?userId=${userIdOrder}&orderExpired=true&orderCancel=false&_expand=camp&_expand=campinfo`)\n                .then(response => {\n\n                    const userOrder = response.data\n                    const sortedOrder = userOrder.sort((a, b) => b.id - a.id); // 根据id排序，由大到小\n\n                    console.log(sortedOrder)\n                    // setData(sortedOrder);\n                    setCampDataResultPast(sortedOrder)\n\n                    setOtherCon(!otherCon)\n                 \n                })\n                .catch(error => {\n                    console.log(error);\n                });\n        }, [finFeedback]);\n        // return Data;\n    }\n    const dataPast = useDataPast();\n\n\n    useEffect(() => {\n\n        const fetchFeedbackData = async (campId) => {\n            try {\n                const response = await axios.get(`http://localhost:3000/feedbacks?campId=${campId}`);\n                return response.data;\n            } catch (error) {\n                console.error(`Error fetching feedback data for campId ${campId}:`, error);\n                return [];\n            }\n        };\n\n        const getFeedbackDataForCamp = async () => {\n            if (campDataResultPast && campDataResultPast.length > 0) {\n                const feedbackDataPromises = campDataResultPast.map((campItem) =>\n                    fetchFeedbackData(campItem.campId)\n                );\n                const feedbackDataArray = await Promise.all(feedbackDataPromises);\n\n                const campDataWithFeedback = campDataResultPast.map((campItem, index) => {\n                    const feedbackDataForCamp = feedbackDataArray[index] || [];\n\n                    const scores = feedbackDataForCamp.map((feedbackItem) => feedbackItem.totalScore);\n\n                    const totalScore = scores.reduce((acc, curr) => acc + curr, 0);\n                    const totalAverageScore = scores.length > 0 ? (totalScore / (scores.length * 5)).toFixed(1) : 0;\n                    // toFixed(1); //只顯示到小數點後一位\n                    const scoreNum = scores.length\n                    // const averageScore = totalScore / scores.length;\n\n\n                    return {\n                        ...campItem,\n                        totalScore,\n                        totalAverageScore,\n                        scoreNum,\n                    };\n                });\n\n                console.log(campDataWithFeedback)\n                setCampDataResultPast(campDataWithFeedback);\n                // 或者根據您的需求，將結果存儲在其他狀態中\n            }\n        };\n\n        getFeedbackDataForCamp();\n    }, [statusPast, otherCon]);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    const [campDataResultCancel, setCampDataResultCancel] = useState([]);\n\n\n\n    function useDataCancel() {\n        // const [Data, setData] = useState(null);\n        useEffect(() => {\n            axios.get(`http://localhost:3000/orders?userId=${userIdOrder}&orderCancel=true&_expand=camp&_expand=campinfo`)\n                .then(response => {\n\n                    const userOrder = response.data\n                    const sortedOrder = userOrder.sort((a, b) => b.id - a.id); // 根据id排序，由大到小\n\n                    console.log(sortedOrder)\n                    // setData(sortedOrder);\n                    setCampDataResultCancel(sortedOrder)\n                })\n                .catch(error => {\n                    console.log(error);\n                });\n        }, []);\n        // return Data;\n    }\n    const dataCancel = useDataCancel();\n\n\n\n    useEffect(() => {\n\n        const fetchFeedbackData = async (campId) => {\n            try {\n                const response = await axios.get(`http://localhost:3000/feedbacks?campId=${campId}`);\n                return response.data;\n            } catch (error) {\n                console.error(`Error fetching feedback data for campId ${campId}:`, error);\n                return [];\n            }\n        };\n\n        const getFeedbackDataForCamp = async () => {\n            if (campDataResultCancel && campDataResultCancel.length > 0) {\n                const feedbackDataPromises = campDataResultCancel.map((campItem) =>\n                    fetchFeedbackData(campItem.campId)\n                );\n                const feedbackDataArray = await Promise.all(feedbackDataPromises);\n\n                const campDataWithFeedback = campDataResultCancel.map((campItem, index) => {\n                    const feedbackDataForCamp = feedbackDataArray[index] || [];\n\n                    const scores = feedbackDataForCamp.map((feedbackItem) => feedbackItem.totalScore);\n\n                    const totalScore = scores.reduce((acc, curr) => acc + curr, 0);\n                    const totalAverageScore = scores.length > 0 ? (totalScore / (scores.length * 5)).toFixed(1) : 0;\n                    // toFixed(1); //只顯示到小數點後一位\n                    const scoreNum = scores.length\n                    // const averageScore = totalScore / scores.length;\n\n\n                    return {\n                        ...campItem,\n                        totalScore,\n                        totalAverageScore,\n                        scoreNum,\n                    };\n                });\n\n                console.log(campDataWithFeedback)\n                setCampDataResultCancel(campDataWithFeedback);\n                // 或者根據您的需求，將結果存儲在其他狀態中\n            }\n        };\n\n        getFeedbackDataForCamp();\n    }, [statusPast]);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    return (\n        <>\n            <DivContentZone className=\"py-5\">\n\n                <div className='h-[70px]'>\n\n                    {/* <h2 className=\"text-xl font-bold\">以下是你的 <span className=\"text-blue-500\">1</span> 筆 訂單記錄</h2>\n                    <strong>準備好開始您的行程了嗎</strong> */}\n\n                    <button onClick={() => setUiTurn(true)}\n                        className={`border border-sub_color rounded-sm py-2 px-3 text-md font-semibold hover:bg-p_color hover:text-white ${uiTurn && 'bg-my_green text-white'\n                            }`}>過去完成記錄</button>\n\n\n                    <button onClick={() => setUiTurn(false)}\n                        className={`border border-sub_color rounded-sm py-2 px-3 text-md font-semibold hover:bg-p_color hover:text-white ${uiTurn === false && 'bg-my_green text-white'\n                            }`}>取消訂單記錄</button>\n\n                </div>\n\n\n\n\n\n                {uiTurn === null &&\n                    <div className='py-10'>\n                        <h3 className=\"mb-3 font-bold text-xl text-my_green\" style={{ letterSpacing: 1 }}>請選擇一個想查看的紀錄 （近期訂單會呈現於最上方）</h3>\n                        \n                        <img className='mx-auto rounded-[40px]' src={campOrder} alt=\"\" />\n                    </div>}\n\n                {uiTurn === true && <MemberBasic getdata={campDataResultPast} status=\"past\" reGetCon={statusPast} setReGetCon={setStatusPast} reGetFeedback={finFeedback} setReGetFeedback={setFinFeedback} userId={userIdOrder}  />}\n\n                {uiTurn === false && <MemberBasic getdata={campDataResultCancel} status=\"cancel\" reGetCon={statusPast} setReGetCon={setStatusPast} />}\n\n\n\n\n            </DivContentZone>\n        </>\n    );\n}\n\nexport default MemberOrder;\n// 匯出這個函式功能\n\n\n\n"],"names":["_useState","useState","_useState2","_slicedToArray","uiTurn","setUiTurn","_useState3","_useState4","finFeedback","setFinFeedback","userIdOrder","localStorage","getItem","console","log","_useState5","_useState6","statusPast","setStatusPast","_useState7","_useState8","campDataResultPast","setCampDataResultPast","_useState9","_useState10","otherCon","setOtherCon","useEffect","axios","concat","then","response","sortedOrder","data","sort","a","b","id","catch","error","fetchFeedbackData","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","campId","wrap","_context","prev","next","sent","abrupt","t0","stop","_x","apply","arguments","getFeedbackDataForCamp","_ref2","_callee2","feedbackDataPromises","feedbackDataArray","campDataWithFeedback","_context2","length","map","campItem","Promise","all","index","scores","feedbackItem","totalScore","reduce","acc","curr","totalAverageScore","toFixed","scoreNum","_objectSpread","_useState11","_useState12","campDataResultCancel","setCampDataResultCancel","_ref3","_callee3","_context3","_x2","_ref4","_callee4","_context4","_jsx","_Fragment","children","_jsxs","DivContentZone","className","onClick","style","letterSpacing","src","campOrder","alt","MemberBasic","getdata","status","reGetCon","setReGetCon","reGetFeedback","setReGetFeedback","userId"],"sourceRoot":""}