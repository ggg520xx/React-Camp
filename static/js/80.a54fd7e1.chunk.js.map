{"version":3,"file":"static/js/80.a54fd7e1.chunk.js","mappings":"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","sources":["components/member/MemberMain.jsx"],"sourcesContent":["// 這個是管理 主右側的內容 左側是外資料夾的 Layout\n// 目前這裡的 content 又分為 上下層分開的路徑 版面寫法  這個裡面 main like mange 只管理 右側下半內容而已 其他不會控制到\nimport React, { useState, useEffect } from \"react\";\n\n\nimport { DivContentZone } from '../memberBasic/MemberBasicStyle'\n\nimport MemberBasic from '../memberBasic/MemberBasic'\nimport axios from 'axios';\n\n\n// import MemberEmptyStyle from './MemberStyle'\n\n\n\nfunction MemberMain() {\n\n\n    let userIdOrder = localStorage.getItem('id');\n    console.log(userIdOrder)\n\n\n\n\n\n    const [statusIng, setStatusIng] = useState(false);\n    const [campDataResult, setCampDataResult] = useState([]);\n\n    function useData() {\n        // 包函式抓不到是因為並沒有開關讓他重啟抓取\n        useEffect(() => {\n\n\n            const fetchCampData = async () => {\n                try {\n                    const response = await axios.get(`http://localhost:3000/orders?userId=${userIdOrder}&orderExpired=false&orderCancel=false&_expand=camp&_expand=campinfo`)\n\n                    setCampDataResult(response.data);\n\n                } catch (error) {\n                    console.error('Error fetching camp data:', error);\n                }\n            };\n\n\n\n            // 取得回饋資料\n            const fetchFeedbackData = async (campId) => {\n                try {\n                    const response = await axios.get(`http://localhost:3000/feedbacks?campId=${campId}`);\n      \n                    return response.data;\n                } catch (error) {\n                    console.error(`Error fetching feedback data for campId ${campId}:`, error);\n                    return [];\n                }\n            };\n\n            const getFeedbackDataForCamp = async () => {\n                if (campDataResult && campDataResult.length > 0) {\n                    const feedbackDataPromises = campDataResult.map((campItem) =>\n                        // 這裡的跟搜尋頁的營區id抓取不一樣 這是訂單的所以依照訂單的 async fetch的物件格式來取得campId資料\n                        fetchFeedbackData(campItem.campId)\n                    );\n                    const feedbackDataArray = await Promise.all(feedbackDataPromises);\n\n                    const campDataWithFeedback = campDataResult.map((campItem, index) => {\n                        const feedbackDataForCamp = feedbackDataArray[index] || [];\n\n                        const scores = feedbackDataForCamp.map((feedbackItem) => feedbackItem.totalScore);\n\n                        const totalScore = scores.reduce((acc, curr) => acc + curr, 0);\n                        const totalAverageScore = scores.length > 0 ? (totalScore / (scores.length * 5)).toFixed(1) : 0;\n                        // toFixed(1); //只顯示到小數點後一位\n                        const scoreNum = scores.length\n                        // const averageScore = totalScore / scores.length;\n\n\n                        return {\n                            ...campItem,\n                            totalScore,\n                            totalAverageScore,\n                            scoreNum,\n                        };\n                    });\n\n                    console.log(campDataWithFeedback)\n                    setCampDataResult(campDataWithFeedback);\n                    // 或者根據您的需求，將結果存儲在其他狀態中\n                }\n            };\n            fetchCampData()\n            getFeedbackDataForCamp();\n\n            \n        }, [statusIng]);\n\n    }\n    useData()\n\n\n\n\n\n    return (\n        <>\n            <DivContentZone className=\"py-5\">\n\n                <div className='h-[70px]'>\n                    <h2 className=\"text-xl font-bold\">歡迎，您尚有 <span className=\"text-blue-500\">{campDataResult && campDataResult.length}</span> 筆 行程待進行或進行中</h2>\n                    <strong>準備好開始您的行程了嗎</strong>\n                </div>\n\n\n\n\n\n                {/* 我把沒有行程記錄 的相關顯示 也寫在統一模版 這樣可以寫一次就好 */}\n                {/* {!dataIng || dataIng.length === 0 ?\n                    <div className='py-10'>\n                        <MemberEmptyStyle  />\n                        <h3 className=\"mt-3 font-bold text-xl text-my_green\" style={{ letterSpacing: 1 }}>當前並無行程\n                        </h3>  \n                    </div>\n                    : null} */}\n\n\n                \n\n\n                <MemberBasic getdata={campDataResult} status=\"ing\" reGetCon={statusIng} setReGetCon={setStatusIng} />\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n            </DivContentZone>\n        </>\n    );\n}\n\n\n\n\n\n\n\nexport default MemberMain;\n// 匯出這個函式功能\n\n\n"],"names":["userIdOrder","localStorage","getItem","console","log","_useState","useState","_useState2","_slicedToArray","statusIng","setStatusIng","_useState3","_useState4","campDataResult","setCampDataResult","useEffect","fetchCampData","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_context","prev","next","axios","concat","sent","data","t0","error","stop","apply","arguments","fetchFeedbackData","_ref2","_callee2","campId","_context2","abrupt","_x","getFeedbackDataForCamp","_ref3","_callee3","feedbackDataPromises","feedbackDataArray","campDataWithFeedback","_context3","length","map","campItem","Promise","all","index","scores","feedbackItem","totalScore","reduce","acc","curr","totalAverageScore","toFixed","scoreNum","_objectSpread","_jsx","_Fragment","children","_jsxs","DivContentZone","className","MemberBasic","getdata","status","reGetCon","setReGetCon"],"sourceRoot":""}